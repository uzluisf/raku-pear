use Pear;
use Pear::Config;
 
=comment APP SETUP
 
# Allow that named arguments appear after positional ones.
# See: https://docs.raku.org/language/create-cli#%*SUB-MAIN-OPTS
my %*SUB-MAIN-OPTS = :named-anywhere;
 
# Set up the directory and the configuration file.
my $work-dir = $*CWD.absolute;
my $config   = Pear::Config.get-config($work-dir);
 
# Set up the application.
my $app = Pear.new(:$work-dir, :$config);
 
=comment CLI OPTIONS
 
#| Render the site.
multi MAIN(
    'render',
    Bool:D :$skip-pages = False, #= Skip pages generation. (Default = False)
    Bool:D :$skip-blog  = False, #= Skip blog generation. (Default = False)
) {
    given $app {
        .generate-posts if !$skip-blog;

        .generate-pages if !$skip-pages;
    }
}
 
#| Start local web server.
multi MAIN(
    'serve',
    Int:D :p(:$port) = 3000, #= Port in which the server should run. (Default = 3000)
) {
    ...
}
